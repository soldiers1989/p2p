ALTER TABLE `S70`.`T7010`
MODIFY COLUMN `F01`  int(6) UNSIGNED NOT NULL DEFAULT 0 COMMENT '今日注册用户数' FIRST ,
MODIFY COLUMN `F02`  int(8) UNSIGNED NOT NULL DEFAULT 0 COMMENT '历史注册用户总数' AFTER `F01`,

-- ----------------------------
-- Procedure structure for SP_T7010
-- ----------------------------
DROP PROCEDURE IF EXISTS `S70`.`SP_T7010`;
DELIMITER ;;
CREATE DEFINER=`root`@`%` PROCEDURE `S70`.`SP_T7010`()
BEGIN
	
	-- 今日注册用户数
	DECLARE _F01 INT unsigned DEFAULT '0';
	-- 历史注册用户总数
	DECLARE _F02 INT unsigned DEFAULT '0';
	-- 今日登录用户数
	DECLARE _F03 INT unsigned DEFAULT '0';
	-- 今日用户总充值
	DECLARE _F04 DECIMAL(20,2) DEFAULT '0.00'; 
	-- 用户历史总充值
	DECLARE _F05 DECIMAL(20,2) DEFAULT '0.00'; 
	-- 今日用户总提现
	DECLARE _F06 DECIMAL(20,2) DEFAULT '0.00'; 
	-- 用户历史总提现
	DECLARE _F07 DECIMAL(20,2) DEFAULT '0.00'; 
	-- 平台总收益
	DECLARE _F08 DECIMAL(20,2) DEFAULT '0.00'; 
	-- 用户投资总收益
	DECLARE _F09 DECIMAL(20,2) DEFAULT '0.00';
	-- 今日用户待还总金额
	DECLARE _F10 DECIMAL(20,2) DEFAULT '0.00';
	-- 用户待还总金额
	DECLARE _F11 DECIMAL(20,2) DEFAULT '0.00';

	-- 用户投资总收益之利息+罚息
	DECLARE _F091 DECIMAL(20,2) DEFAULT '0.00';

	-- 用户投资总收益之债权转入盈亏
	DECLARE _F092 DECIMAL(20,2) DEFAULT '0.00';

	-- 用户投资总收益之债权转出盈亏
	DECLARE _F093 DECIMAL(20,2) DEFAULT '0.00';

	DECLARE _ID INT DEFAULT 0;

	SELECT COUNT(*) INTO _F01 FROM S61.T6110 WHERE TO_DAYS(S61.T6110.F09) = TO_DAYS(NOW());
	SELECT COUNT(*) INTO _F02 FROM S61.T6110 ;
  	SELECT IFNULL(SUM(T6502.F03),0) INTO _F04 FROM S65.T6502 INNER JOIN S65.T6501 ON T6501.F01=T6502.F01 WHERE T6501.F03='CG' AND TO_DAYS(T6501.F06) = TO_DAYS(NOW());
	SELECT IFNULL(SUM(T6502.F03),0) INTO _F05 FROM S65.T6502 INNER JOIN S65.T6501 ON T6501.F01=T6502.F01 WHERE T6501.F03='CG';
	SELECT IFNULL(SUM(T6503.F03),0) INTO _F06 FROM S65.T6503 INNER JOIN S65.T6501 ON T6501.F01=T6503.F01 WHERE T6501.F03='CG' AND TO_DAYS(T6501.F06) = TO_DAYS(NOW());
	SELECT IFNULL(SUM(T6503.F03),0) INTO _F07 FROM S65.T6503 INNER JOIN S65.T6501 ON T6501.F01=T6503.F01 WHERE T6501.F03='CG';
	SELECT T6101.F01 INTO _ID FROM S71.T7101 INNER JOIN S61.T6101 WHERE T7101.F01=T6101.F02 AND T6101.F03='WLZH' LIMIT 1;
	SELECT IFNULL(SUM(T6102.F06-T6102.F07),0) INTO _F08 FROM S61.T6102 WHERE T6102.F02=_ID;

	-- 利息收益
	SELECT IFNULL(SUM(T6102.F06), 0) INTO _F091 FROM S61.T6102 WHERE T6102.F03 IN (7004,7005,7002) AND T6102.F02 IN (SELECT T6101.F01 FROM S61.T6101,S61.T6110 WHERE T6101.F02 = T6110.F01 AND T6101.F03 = 'WLZH');

	-- 转入盈亏
	SELECT IFNULL(SUM(T6262.F08),0) INTO _F092 FROM S62.T6262,S61.T6110 WHERE T6262.F03 = T6110.F01;

	-- 转出盈亏
	SELECT IFNULL(SUM(T6262.F09), 0) INTO _F093 FROM S62.T6262,S62.T6260,S62.T6251,S61.T6110 WHERE T6251.F04 = T6110.F01 AND T6251.F01 = T6260.F02 AND T6260.F01 = T6262.F02;

	 SELECT (_F091+_F092+_F093) INTO _F09;

	SELECT IFNULL(SUM(F07),0) INTO _F10 FROM S62.T6252 WHERE F09='WH' AND TO_DAYS(F08) <= TO_DAYS(NOW());
	SELECT IFNULL(SUM(F07),0) INTO _F11 FROM S62.T6252 WHERE F09='WH'; 
	
	UPDATE S70.T7010 SET F01 = _F01,F02 = _F02,F03 = _F03,F04 = _F04,F05 = _F05,F06 = _F06,F07 = _F07,F08 = _F08,F09 = _F09, F10 = _F10, F11 = _F11;
	
END
;;
DELIMITER ;